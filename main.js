"use strict";(self.webpackChunkBattleShip=self.webpackChunkBattleShip||[]).push([[179],{178:(e,t,n)=>{const s={create:function(e,t){e||console.log("missing type");const n=document.createElement(e);for(const[e,s]of Object.entries(t))n[e]=s;return n},appendAll:function(e,t){t.forEach((t=>e.appendChild(t)))},deleteAppContent:function(){document.getElementById("app").replaceChildren("")},getHeader:function(e){const t=document.createElement("header");t.classList.add("header",`${e}`);const n=document.createElement("h1");return n.textContent="BATTLESHIP",t.appendChild(n),t},createMap:function(e){const t=document.createElement("div");return t.id=`board-${e}`,t.classList.add("board",e),t.appendChild(function(){const e=document.createElement("div");return e.classList="letter-container",["A","B","C","D","E","F","G","H","I","J"].forEach((t=>{const n=document.createElement("div");n.className="letter",n.textContent=t,e.appendChild(n)})),e}()),t.appendChild(function(){const e=document.createElement("div");return e.id="number-container",e.classList="number-container",[1,2,3,4,5,6,7,8,9,10].forEach((t=>{const n=document.createElement("div");n.classList="number",n.textContent=t,e.appendChild(n)})),e}()),t.appendChild(function(e){const t=document.createElement("div");t.id=`field-container-${e}`,t.className=`field-container field-container-${e}`;for(let e=0;e<10;e+=1)for(let e=0;e<10;e+=1){const e=document.createElement("div");e.className="field",t.appendChild(e)}return t}(e)),t},getCoordinatesFromIndex:function(e){return[parseInt(e/10,10),e%10]},getIndexFromCoordinates:function(e,t){return 10*e+t},roundNearestTenExceptZero:function(e){for(;e%10!=0;)e+=1;return e}},a=s,i={createShip:(e,t)=>{const n=e,s=t;let a=0,i=!1,o=!1;function r(){i=!0}return{getName:function(){return n},getLength:function(){return s},getSunk:function(){return i},getFound:function(){return o},hit:function(){a+=1,a===s&&r()},sunk:r,found:function(){o=!0},resetFound:function(){o=!1}}}},o={createMap:()=>{const e=new Array(10).fill("x").map((()=>new Array(10).fill("x"))),t={name:"",length:0};let n=[],s="X";function a(e){return n.filter((t=>t.getName()===e))[0]}function o(e){switch(e.getName()){case"carrier":n.push(i.createShip("carrier",5));break;case"battleship":n.push(i.createShip("battleship",4));break;case"cruiser":n.push(i.createShip("cruiser",3));break;case"submarine":n.push(i.createShip("submarine",3));break;default:n.push(i.createShip("destroyer",2))}}function r(e,t,n){return e>t-n}function c(t,n){switch(e[t][n]){case"carrierX":case"carrierY":a("carrier").hit();break;case"battleshipX":case"battleshipY":a("battleship").hit();break;case"cruiserX":case"cruiserY":a("cruiser").hit();break;case"submarineX":case"submarineY":a("submarine").hit();break;case"destroyerX":case"destroyerY":a("destroyer").hit();break;default:e[t][n]="miss"}}return{getBoard:function(){return e},getFleet:function(){return n},getShip:a,getAxis:function(){return s},getShipOnDrag:function(){return t},setAxisX:function(){s="X"},setAxisY:function(){s="Y"},setFleetEmpty:function(){n=[]},setAllShipsNotFound:function(){n.forEach((e=>e.resetFound()))},setShipOnDrag:function(e){t.name=e.name,t.length=e.length},addToFleet:o,placeX:function(t,n){let s=t.getLength();const[a,i]=n,c=[];if(r(s,e.length,i))return!1;for(let t=i;t<e.length;t++){if("x"!==e[a][t])return!1;if(c.push([a,t]),s-=1,0===s)break}return c.forEach((n=>{const[s,a]=n;e[s][a]=`${t.getName()}X`})),o(t),!0},placeY:function(t,n){let s=t.getLength();const[a,i]=n,c=[];if(r(s,e.length,a))return!1;for(let t=a;t<e.length;t++){if("x"!==e[t][i])return!1;if(c.push([t,i]),s-=1,0===s)break}return c.forEach((n=>{const[s,a]=n;e[s][a]=`${t.getName()}Y`})),o(t),!0},receiveAttack:function(e){const[t,n]=e;c(t,n)},recordHit:c,areAllShipsFound:function(){return 5===n.length},isEveryShipSunk:function(){return 5===n.filter((e=>!0===e.getSunk())).length}}}},r=o,c=(()=>{function e(){return Math.floor(10*Math.random())}function t(e){const t=Math.floor(Math.random()*(e.length-1))+1,n=e[t];return e.splice(t,1),n}return{createPlayer:(n,s)=>{const a=s,o=r.createMap();let c=n,u=[];function l(){return o}function d(e){const[t,n]=e;return"miss"!==l().getBoard()[t][n]&&"hit"!==l().getBoard()[t][n]}function p(e,t){if(1===u.length&&(u=[]),"miss"===l().getBoard()[e][t])return;let n=!1;0===u.length&&(u.push([e,t]),n=!0),e>0&&e<=9&&u.push([e-1,t]),e>=0&&e<9&&u.push([e+1,t]),t>0&&t<=9&&u.push([e,t-1]),t>=0&&t<9&&u.push([e,t+1]),u.length>1&&!n&&(console.log(e,t),e===u[0][0]?(console.log("c"),u=[...u.slice(0,1),...u.slice(1).filter((t=>t[0]===e))]):t===u[0][1]&&(console.log("d"),u=[...u.slice(0,1),...u.slice(1).filter((e=>e[1]===t))]))}return{getName:function(){return c},getIdentity:function(){return a},getMap:l,setName:function(e){c=e},fillQueue:p,cpuPlay:function(){let n,s,a=!0;for(;a;)u.length>1?[n,s]=t(u):(n=e(),s=e()),d([n,s])&&(a=!1,l().receiveAttack([n,s]));return p(n,s),console.log(u),[n,s]},autoPlace:function(){const t=["carrier","battleship","cruiser","submarine","destroyer"],n=[5,4,3,3,2];for(;t.length;){const s=["x","y"][Math.round(Math.random())],a=e(),o=e();let r=!1;r="x"===s?l().placeX(i.createShip(t[0],n[0]),[a,o]):l().placeY(i.createShip(t[0],n[0]),[a,o]),r&&(t.shift(),n.shift())}},isEmptyField:d,isLoser:function(){return l().getFleet().every((e=>!0===e.getSunk()))}}}}})(),u=c,l=(()=>{function e(){return this.state}function t(){return this.player}function n(){return this.cpu}return{state:{player:u.createPlayer("Captain","player"),cpu:u.createPlayer("cpu","cpu"),getPlayer:t,getCPU:n},getState:e,setPlayerName:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Captain";e().getPlayer().setName(t)}}})(),d=n.p+"img/carrierX008846a84b2a34dde315.svg",p=n.p+"img/battleshipXd56e5a89beb359219e25.svg",h=n.p+"img/cruiserX0504ee6feab7e47038d3.svg",g=n.p+"img/submarineX543bf6eb30d63dfd7a2f.svg",m=n.p+"img/destroyerX56e5c8a88ff718d93efc.svg",f=(()=>{let e=null;function t(t,n){const s=n.element.slice(0,-1),i=t.getMap().getShip(s);if(i.getFound())return;i.found(),console.log(i);const o=i.getLength(),[r,c]=["10%",10*o+"%"],[u,l]=[10*n.row+"%",10*n.col+"%"];let f="rotate(0deg)";"Y"===n.element.at(-1)&&(f="rotate(90deg) translate(0,-100%)");const y=(null===e&&(e=(new Date).getTime()),((new Date).getTime()-e)/1e3),b=a.create("div",{className:"ship-image-container"});b.classList.add("bleep"),b.style.position="absolute",b.style.zIndex="-1",b.style.top=u,b.style.left=l,b.style.width=c,b.style.height=r,b.style.transform=f,b.style.transformOrigin="top left",b.style.maskImage=d,b.style.animationDelay=-y+"s";const w=a.create("img",{className:`${s}-${t.getIdentity()}`});w.src=function(e){let t;switch(e){case"carrier":t=d;break;case"battleship":t=p;break;case"cruiser":t=h;break;case"submarine":t=g;break;case"destroyer":t=m;break;default:t=""}return t}(s),w.style.height="95%",w.style.aspectRatio=`${o}/1`,b.appendChild(w),n.board.appendChild(b)}return{loadFleet:function(e){const n=l.getState().getPlayer(),s=n.getMap(),a=s.getBoard();for(let i=0;i<a.length;i+=1)for(let o=0;o<a[0].length;o+=1)"x"!==a[i][o]&&t(n,{map:s,board:e,element:a[i][o],row:i,col:o})},loadShipOnBoard:t}})(),y=f;function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},b.apply(this,arguments)}var w={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onBegin:function(e){},onComplete:function(e){},preStringTyped:function(e,t){},onStringTyped:function(e,t){},onLastStringBackspaced:function(e){},onTypingPaused:function(e,t){},onTypingResumed:function(e,t){},onReset:function(e){},onStop:function(e,t){},onStart:function(e,t){},onDestroy:function(e){}},v=new(function(){function e(){}var t=e.prototype;return t.load=function(e,t,n){if(e.el="string"==typeof n?document.querySelector(n):n,e.options=b({},w,t),e.isInput="input"===e.el.tagName.toLowerCase(),e.attr=e.options.attr,e.bindInputFocusEvents=e.options.bindInputFocusEvents,e.showCursor=!e.isInput&&e.options.showCursor,e.cursorChar=e.options.cursorChar,e.cursorBlinking=!0,e.elContent=e.attr?e.el.getAttribute(e.attr):e.el.textContent,e.contentType=e.options.contentType,e.typeSpeed=e.options.typeSpeed,e.startDelay=e.options.startDelay,e.backSpeed=e.options.backSpeed,e.smartBackspace=e.options.smartBackspace,e.backDelay=e.options.backDelay,e.fadeOut=e.options.fadeOut,e.fadeOutClass=e.options.fadeOutClass,e.fadeOutDelay=e.options.fadeOutDelay,e.isPaused=!1,e.strings=e.options.strings.map((function(e){return e.trim()})),e.stringsElement="string"==typeof e.options.stringsElement?document.querySelector(e.options.stringsElement):e.options.stringsElement,e.stringsElement){e.strings=[],e.stringsElement.style.cssText="clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;";var s=Array.prototype.slice.apply(e.stringsElement.children),a=s.length;if(a)for(var i=0;i<a;i+=1)e.strings.push(s[i].innerHTML.trim())}for(var o in e.strPos=0,e.arrayPos=0,e.stopNum=0,e.loop=e.options.loop,e.loopCount=e.options.loopCount,e.curLoop=0,e.shuffle=e.options.shuffle,e.sequence=[],e.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},e.typingComplete=!1,e.strings)e.sequence[o]=o;e.currentElContent=this.getCurrentElContent(e),e.autoInsertCss=e.options.autoInsertCss,this.appendAnimationCss(e)},t.getCurrentElContent=function(e){return e.attr?e.el.getAttribute(e.attr):e.isInput?e.el.value:"html"===e.contentType?e.el.innerHTML:e.el.textContent},t.appendAnimationCss=function(e){var t="data-typed-js-css";if(e.autoInsertCss&&(e.showCursor||e.fadeOut)&&!document.querySelector("["+t+"]")){var n=document.createElement("style");n.type="text/css",n.setAttribute(t,!0);var s="";e.showCursor&&(s+="\n        .typed-cursor{\n          opacity: 1;\n        }\n        .typed-cursor.typed-cursor--blink{\n          animation: typedjsBlink 0.7s infinite;\n          -webkit-animation: typedjsBlink 0.7s infinite;\n                  animation: typedjsBlink 0.7s infinite;\n        }\n        @keyframes typedjsBlink{\n          50% { opacity: 0.0; }\n        }\n        @-webkit-keyframes typedjsBlink{\n          0% { opacity: 1; }\n          50% { opacity: 0.0; }\n          100% { opacity: 1; }\n        }\n      "),e.fadeOut&&(s+="\n        .typed-fade-out{\n          opacity: 0;\n          transition: opacity .25s;\n        }\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\n          -webkit-animation: 0;\n          animation: 0;\n        }\n      "),0!==n.length&&(n.innerHTML=s,document.body.appendChild(n))}},e}()),C=new(function(){function e(){}var t=e.prototype;return t.typeHtmlChars=function(e,t,n){if("html"!==n.contentType)return t;var s=e.substr(t).charAt(0);if("<"===s||"&"===s){var a;for(a="<"===s?">":";";e.substr(t+1).charAt(0)!==a&&!(1+ ++t>e.length););t++}return t},t.backSpaceHtmlChars=function(e,t,n){if("html"!==n.contentType)return t;var s=e.substr(t).charAt(0);if(">"===s||";"===s){var a;for(a=">"===s?"<":"&";e.substr(t-1).charAt(0)!==a&&!(--t<0););t--}return t},e}()),E=function(){function e(e,t){v.load(this,t,e),this.begin()}var t=e.prototype;return t.toggle=function(){this.pause.status?this.start():this.stop()},t.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},t.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},t.destroy=function(){this.reset(!1),this.options.onDestroy(this)},t.reset=function(e){void 0===e&&(e=!0),clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,e&&(this.insertCursor(),this.options.onReset(this),this.begin())},t.begin=function(){var e=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout((function(){e.currentElContent&&0!==e.currentElContent.length?e.backspace(e.currentElContent,e.currentElContent.length):e.typewrite(e.strings[e.sequence[e.arrayPos]],e.strPos)}),this.startDelay)},t.typewrite=function(e,t){var n=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var s=this.humanizer(this.typeSpeed),a=1;!0!==this.pause.status?this.timeout=setTimeout((function(){t=C.typeHtmlChars(e,t,n);var s=0,i=e.substr(t);if("^"===i.charAt(0)&&/^\^\d+/.test(i)){var o=1;o+=(i=/\d+/.exec(i)[0]).length,s=parseInt(i),n.temporaryPause=!0,n.options.onTypingPaused(n.arrayPos,n),e=e.substring(0,t)+e.substring(t+o),n.toggleBlinking(!0)}if("`"===i.charAt(0)){for(;"`"!==e.substr(t+a).charAt(0)&&(a++,!(t+a>e.length)););var r=e.substring(0,t),c=e.substring(r.length+1,t+a),u=e.substring(t+a+1);e=r+c+u,a--}n.timeout=setTimeout((function(){n.toggleBlinking(!1),t>=e.length?n.doneTyping(e,t):n.keepTyping(e,t,a),n.temporaryPause&&(n.temporaryPause=!1,n.options.onTypingResumed(n.arrayPos,n))}),s)}),s):this.setPauseStatus(e,t,!0)},t.keepTyping=function(e,t,n){0===t&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var s=e.substr(0,t+=n);this.replaceText(s),this.typewrite(e,t)},t.doneTyping=function(e,t){var n=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout((function(){n.backspace(e,t)}),this.backDelay))},t.backspace=function(e,t){var n=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var s=this.humanizer(this.backSpeed);this.timeout=setTimeout((function(){t=C.backSpaceHtmlChars(e,t,n);var s=e.substr(0,t);if(n.replaceText(s),n.smartBackspace){var a=n.strings[n.arrayPos+1];n.stopNum=a&&s===a.substr(0,t)?t:0}t>n.stopNum?(t--,n.backspace(e,t)):t<=n.stopNum&&(n.arrayPos++,n.arrayPos===n.strings.length?(n.arrayPos=0,n.options.onLastStringBackspaced(),n.shuffleStringsIfNeeded(),n.begin()):n.typewrite(n.strings[n.sequence[n.arrayPos]],t))}),s)}else this.setPauseStatus(e,t,!1)},t.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},t.setPauseStatus=function(e,t,n){this.pause.typewrite=n,this.pause.curString=e,this.pause.curStrPos=t},t.toggleBlinking=function(e){this.cursor&&(this.pause.status||this.cursorBlinking!==e&&(this.cursorBlinking=e,e?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))},t.humanizer=function(e){return Math.round(Math.random()*e/2)+e},t.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort((function(){return Math.random()-.5})))},t.initFadeOut=function(){var e=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout((function(){e.arrayPos++,e.replaceText(""),e.strings.length>e.arrayPos?e.typewrite(e.strings[e.sequence[e.arrayPos]],0):(e.typewrite(e.strings[0],0),e.arrayPos=0)}),this.fadeOutDelay)},t.replaceText=function(e){this.attr?this.el.setAttribute(this.attr,e):this.isInput?this.el.value=e:"html"===this.contentType?this.el.innerHTML=e:this.el.textContent=e},t.bindFocusEvents=function(){var e=this;this.isInput&&(this.el.addEventListener("focus",(function(t){e.stop()})),this.el.addEventListener("blur",(function(t){e.el.value&&0!==e.el.value.length||e.start()})))},t.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},e}();const S=n.p+"img/agent2d80167d315204e60bc4.png",k=n.p+"img/evilCaptain9aae6a9e96b92014ac6c.png",N=(()=>{const e={agent:S,enemy:k};return{createMessageSection:function(t){const n=a.create("section",{className:"message"});t.forEach((e=>n.classList.add(e)));const s=t[1],i=a.create("img",{className:"message-image"}),o="agent"===t[1]||"agent-win"===t[1]?"agent":"enemy";return i.src=e[o],n.appendChild(i),n.appendChild(function(e){const t=a.create("div",{id:"message-container",className:"message-container"}),n=a.create("div",{id:`message-${e}`,className:`message-${e}`});return t.appendChild(n),t}(s)),n},addTypeWriterMessage:function(e,t){new E(e,{strings:t,typeSpeed:10})},createShipCard:function(e){const t=a.create("div",{className:"ship-card",draggable:"true"}),n=a.create("div",{className:"ship-content"}),s=a.create("img",{className:"ship-image"}),i=a.create("p",{className:"ship-name"});switch(e){case"carrier":t.dataset.shipName="carrier",t.dataset.shipLength=5,s.src=d,i.textContent="Carrier (5f)";break;case"battleship":t.dataset.shipName="battleship",t.dataset.shipLength=4,s.src=p,i.textContent="Battleship (4f)";break;case"cruiser":t.dataset.shipName="cruiser",t.dataset.shipLength=3,s.src=h,i.textContent="Cruiser (3f)";break;case"submarine":t.dataset.shipName="submarine",t.dataset.shipLength=3,s.src=g,i.textContent="Submarine (3f)";break;case"destroyer":t.dataset.shipName="destroyer",t.dataset.shipLength=2,s.src=m,i.textContent="Destroyer (2f)"}return a.appendAll(n,[s,i]),t.appendChild(n),t}}})(),B=(()=>{const e={welcome:["Welcome aboard","Plan our formation by selecting the axis and dragging and dropping ships on the map."],battleStartPlayer:["all systems are online and ready for action. Let's give 'em hell!"],battleStartEnemy:["I'll show you no mercy, just like your father showed none to mine."],enemyHit:["They're getting schooner-ed, sir.","This battle is a tidal wave of victory!","The enemy ship is feeling the pressure, sir.","We've got them on the ropes sir, I mean rigging!","That was textbook, Captain. They're going down in no time.","Target hit. Enemy vessel has sustained significant damage.","Captain, we have successfully landed a blow on the enemy vessel.","That hit was right on the money, Captain. We've got them reeling.","BOOM! Enemy ship gets hit hard! That's what I call a depth charge!","Direct hit achieved. Enemy ship's combat effectiveness is significantly reduced."],enemySunk:["Captain, the enemy vessel is going down. That was one hell of a shot.","Sir, that was a hit for the history books. The enemy ship has been sunk.","We've just sunk the enemy ship, Captain. They won't be troubling us anymore.","Captain, we've just delivered a knockout blow. The enemy ship has been sunk.","We've just sent the enemy ship to Davy Jones' locker, Captain. Job well done.","Captain, the enemy ship has been vanquished. They won't be bothering us again.","That hit was a decisive blow, Captain. The enemy ship has met its watery grave.","That was a direct hit, Captain. The enemy ship is now resting on the ocean floor.","The enemy ship has been put out of commission. They won't be troubling us anymore.","We've just given the enemy ship a one-way ticket to the bottom of the ocean, Captain."],playerMiss:["Close, but no cigar.","Our aim needs work, captain.","Negative on that shot, captain.","No hit, captain. Keep fighting.","That was a swing and a miss, sir.","No dice on that one. Keep trying!","The enemy is proving to be elusive, sir.","Looks like we need to adjust our aim, sir.","Looks like we need to recalibrate our aim, sir.","We're not making much headway, captain. What's the plan?"],playerHit:["Your time is up!","Hehehe, your luck is running out,","Brace yourself for the real pain!","That was just a taste of what's to come.","You'll be swimming with the fishes soon enough.","My torpedoes have your number, it's over for you!","So predictable, you're not even worth the ammunition","How does it feel to be on the receiving end of my wrath?","Your luck has run out, and there's nowhere left to hide!","Looks like I hit a nerve. How about a little retaliation?"],playerSunk:["Looks like you'll be swimming home. Hehehe.","You fought like a coward and died like a dog.","Looks like your ship was no match for our firepower.","Another one bites the dust. It's too easy to crush your kind.","Your demise was inevitable. The sea always takes what it wants.","Did you really think you stood a chance against us? How foolish.","It's a shame your ship couldn't withstand the might of our fleet.","The ocean belongs to the strong. Your ship didn't stand a chance.","You made a grave mistake challenging me. Your defeat was certain.","You should have surrendered while you had the chance. Now look at you."],enemyMiss:["I'll get you next time.","My turn to strike again.","Missed, but not for long.","You can run, but you can't hide.","You can't escape my sight forever.","Your luck is just prolonging the inevitable.","My torpedoes will find you, no matter where you hide.","You may have dodged one, but you can't dodge them all.","That was just a warning shot, the real attack is coming.","You're playing with fire, and I have a lot of ammunition."],noComment:["..."],playerWin:["Mission accomplished, Captain! You truly are the master of the seas."],enemyWin:["You were no match for me scum. Consider it payback for what your father did to mine."]};function t(){return Math.floor(10*Math.random())}return{getWelcomeMessage:function(){return e.welcome[0]+=` ${l.getState().getPlayer().getName()}!`,e.welcome},getBattleStartMessage:function(){return[`${l.getState().getPlayer().getName()} ${e.battleStartPlayer[0]}`]},getNewEnemyBattleStartMessage:function(){return e.battleStartEnemy},getNewEnemyHitMessage:function(n){let s=n;for(;s===n;)s=e.enemyHit[t()];return s},getNewEnemySunkMessage:function(n){let s=n;for(;s===n;)s=e.enemySunk[t()];return s},getNewPlayerMissMessage:function(n){let s=n;for(;s===n;)s=e.playerMiss[t()];return s},getNewPlayerHitMessage:function(n){let s=n;for(;s===n;)s=e.playerHit[t()];return s},getNewPlayerSunkMessage:function(n){let s=n;for(;s===n;)s=e.playerSunk[t()];return s},getNewEnemyMissMessage:function(n){let s=n;for(;s===n;)s=e.enemyMiss[t()];return s},getNoCommentMessage:function(){return e.noComment},getPlayerWinMessage:function(){return e.playerWin},getEnemyWinMessage:function(){return e.enemyWin}}})(),L=n.p+"img/shote38f594694469ba3b826.mp3",x=n.p+"img/hit96a50b265841ced7c235.mp3",M=n.p+"img/miss058afc203bb520b90d96.mp3",I=(()=>{function e(e){const t=new(window.AudioContext||window.webkitAudioContext),n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{t.decodeAudioData(n.response,(e=>{const n=t.createBufferSource();n.buffer=e,n.connect(t.destination),n.start(0)})),t.resume()},n.send()}async function t(){const e=await n.e(925).then(n.t.bind(n,925,17)),t=new Audio(e.default);t.loop=!0,t.play()}return{shot:function(){e(L)},hit:function(){e(x)},miss:function(){e(M)},BackgroundOnFirstTouch:function(){/Android|iPhone/i.test(navigator.userAgent)?document.addEventListener("touchstart",t,{once:!0}):document.addEventListener("click",t,{once:!0})}}})(),T=(()=>{function e(){const e=a.createMap("friendly");return e.appendChild(n("FRIENDLY WATERS")),e}function t(){const e=a.createMap("enemy");return e.appendChild(n("ENEMY WATERS")),e}function n(e){const t=a.create("div",{className:"map-title-container"}),n=a.create("h3",{className:"map-title",textContent:e});return t.appendChild(n),t}function s(e){const t=a.create("section",{id:"win-modal-container",className:"win-modal-container"});t.classList.add(e.className);const n=a.create("h4",{id:`title-${e.id}`,className:`title-${e.id}`,textContent:e.title}),s=N.createMessageSection(["battle",e.id]),i=a.create("button",{id:"new-game-button",className:"new-game-button",textContent:"New Battle"});return a.appendAll(t,[n,s,i]),t}function i(){return a.create("div",{className:"win-overlay"})}function o(){document.getElementById("new-game-button").addEventListener("click",(()=>window.location.reload()))}function r(){document.getElementById("board-enemy").querySelector(".field-container").childNodes.forEach((e=>{e.addEventListener("click",u)})),document.getElementById("field-container-enemy").classList.remove("disabled")}function c(){document.querySelectorAll(".field").forEach((e=>e.removeEventListener("click",u))),C(document.getElementById("field-container-enemy"))}async function u(e){const{target:t}=e;C(t);const n=await async function(e){const t=l.getState().getCPU(),n=[...e.parentNode.children].indexOf(e),[u,d]=a.getCoordinatesFromIndex(n),m=t.getMap().getBoard()[u][d],b=g(m),v=t.getMap().getShip(b);return c(),await p("player"),"x"!==m?await async function(e){const t=l.getState().getCPU(),n=[...e.parentNode.children].indexOf(e),[u,d]=a.getCoordinatesFromIndex(n),p=t.getMap().getBoard()[u][d],h=g(p),m=t.getMap().getShip(h);return E(e),function(e){const t=document.getElementById("field-container-enemy"),n=e.cpu.getMap(),s=n.getBoard();if(n.receiveAttack([e.row,e.col]),e.battleship.getSunk()){const a=s[e.row][e.col],[i,o]=function(e,t){for(let n=0;n<e.length;n+=1)for(let s=0;s<e[0].length;s+=1)if(e[n][s]===t)return[n,s];return[0,0]}(s,s[e.row][e.col]);y.loadShipOnBoard(e.cpu,{map:n,board:t,element:a,row:i,col:o})}}({cpu:t,battleship:m,row:u,col:d}),await T(),I.hit(),f(p,m),await x(),t.isLoser()?function(){const e=document.getElementById("app");return a.appendAll(e,[s({title:"YOU WIN!",id:"agent-win",className:"player"}),i()]),w("agent-win"),o(),c(),"win"}():(r(),"hit")}(e):(await async function(e){S(e),await T(),I.miss()}(e),f(m,v),await x(),await h("player"),"miss")}(t);if("win"===n||"hit"===n)return;let u=await d();if("win"!==u)for(;"hit"===u;)u=await d()}async function d(){const e=l.getState().getPlayer(),[t,n]=e.cpuPlay(),r=e.getMap().getBoard()[t][n],c=g(r),u=e.getMap().getShip(c);return await p("cpu"),"miss"!==r?await async function(e,t){const n=document.getElementById("field-container-friendly"),r=l.getState().getPlayer(),c=a.getIndexFromCoordinates(e,t),u=r.getMap().getBoard()[e][t],d=g(u),p=r.getMap().getShip(d);return E(n.children[c]),r.getMap().getBoard()[e][t]="hit",await T(),I.hit(),b(u,p),r.isLoser()?function(){const e=document.getElementById("app");return a.appendAll(e,[s({title:"YOU LOSE!",id:"enemy-win",className:"enemy"}),i()]),w("enemy-win"),o(),"win"}():"hit"}(t,n):(await async function(e,t){const n=document.getElementById("field-container-friendly"),s=l.getState().getPlayer(),i=a.getIndexFromCoordinates(e,t);S(n.children[i]),s.getMap().getBoard()[e][t]="miss",await T(),I.miss()}(t,n),b(r,u),await x(),await h("cpu"),"miss")}async function p(e){"player"===e?(I.shot(),await M()):(v(document.getElementById("message-agent"),B.getNoCommentMessage()[0]),await x(),I.shot(),await M())}async function h(e){await new Promise((e=>setTimeout(e,1500))),"player"===e?(L(document.querySelector(".message.battle.agent")),k(document.querySelector(".message.battle.enemy")),L(document.getElementById("board-friendly")),k(document.getElementById("board-enemy"))):(L(document.querySelector(".message.battle.enemy")),k(document.querySelector(".message.battle.agent")),L(document.getElementById("board-enemy")),k(document.getElementById("board-friendly")),r())}function g(e){return e.slice(0,e.length-1)}function m(e){const t=document.getElementById(`message-${e}`);"agent"===e?N.addTypeWriterMessage(t,B.getBattleStartMessage()):N.addTypeWriterMessage(t,B.getNewEnemyBattleStartMessage())}function f(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.getElementById("message-agent"),s=document.getElementById("message-enemy");"x"!==e?t&&!t.isSunk?v(n,B.getNewEnemyHitMessage(n.textContent)):t.isSunk&&v(n,B.getNewEnemySunkMessage(n.textContent)):v(n,B.getNewPlayerMissMessage(n.textContent)),"..."!==s.textContent&&v(s,B.getNoCommentMessage()[0])}function b(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.getElementById("message-enemy");"x"!==e&&"miss"!==e?t&&!t.isSunk?v(n,B.getNewPlayerHitMessage(n.textContent)):t.isSunk&&v(n,B.getNewPlayerSunkMessage(n.textContent)):v(n,B.getNewEnemyMissMessage(n.textContent))}function w(e){const t=document.getElementById(`message-${e}`);"agent-win"===e&&N.addTypeWriterMessage(t,B.getPlayerWinMessage()),"enemy-win"===e&&N.addTypeWriterMessage(t,B.getEnemyWinMessage())}function v(e,t){!function(e){e.nextElementSibling&&(e.textContent="",e.nextElementSibling.remove())}(e),N.addTypeWriterMessage(e,[t])}function C(e){e.classList.add("disabled")}function E(e){e.classList.add("hit")}function S(e){e.classList.add("miss")}function k(e){e.classList.remove("off-turn"),e.classList.add("on-turn")}function L(e){e.classList.remove("on-turn"),e.classList.add("off-turn")}function x(){return new Promise((e=>setTimeout(e,1e3)))}function M(){return new Promise((e=>setTimeout(e,500)))}function T(){return new Promise((e=>setTimeout(e,300)))}return{loadBattleContent:function(){a.deleteAppContent();const n=document.getElementById("app");n.classList.replace("setup","battle"),n.appendChild(function(){const n=a.create("div",{className:"battle-wrapper"});return a.appendAll(n,[e(),t(),N.createMessageSection(["battle","agent"]),N.createMessageSection(["battle","enemy"])]),n}()),function(){const e=document.getElementById("field-container-friendly");l.getState().getPlayer().getMap().setAllShipsNotFound(),y.loadFleet(e)}(),l.getState().getCPU().autoPlace(),m("agent"),m("enemy"),r(),k(document.querySelector(".message.battle.agent"))}}})(),P=T,A=(()=>{let e=[],t=!1;function n(){e=[]}function s(e,t){h(t),e.stopPropagation()}function o(e){e.preventDefault()}function r(){g()}function c(e,t){const n=l.getState().getPlayer().getMap(),s=l.getState().getPlayer().getMap().getShipOnDrag();return"X"===n.getAxis()?[n.placeX(i.createShip(s.name,s.length),[e,t]),s.name]:[n.placeY(i.createShip(s.name,s.length),[e,t]),s.name]}function u(e,n,s,a,i,o){t=!0,e.stopPropagation(),e.preventDefault(),i.appendChild(n),h(n);const r=l.getState().getPlayer().getMap().getShipOnDrag(),c=e.targetTouches[0],u=e.touches[0].clientX,d=e.touches[0].clientY;!function(e,t,n){if(e&&t.childNodes.length<5){const e=N.createShipCard(n.name);t.appendChild(e),e.classList.add("hidden")}}(t,a,r),function(e,t,n){e.style.position="fixed",e.style.zIndex="5",e.style.left=`${t}px`,e.style.top=`${n}px`}(n,c.clientX,c.clientY);const m=document.elementFromPoint(u,d);o[0]!==m&&g(),o[0]=m,o[0].classList.contains("field")&&f(s,p(o[0]))}function d(e,n){if(!t)return;const i=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY,r=n.dataset.shipName,l=document.getElementById("field-container-setup"),h=document.elementFromPoint(i,o),f=document.querySelector(`[data-ship-name="${r}"]`);if(h.classList.contains("field")){const e=p(h),[t,n]=a.getCoordinatesFromIndex(e),[s,i]=c(t,n);y.loadFleet(l),g(),m(s,i),s||f.classList.remove("hidden")}else f.classList.remove("hidden");t=!1,n.remove(),function(e){const t=document.getElementById("fleet-setup"),n=document.getElementById("field-container-setup"),a=document.getElementById("app"),i=[null];e.addEventListener("dragstart",(t=>{s(t,e)})),e.addEventListener("touchmove",(s=>u(s,e,n,t,a,i)),{passive:!1}),e.addEventListener("touchend",(t=>d(t,e)))}(f)}function p(e){return[...e.parentNode.children].indexOf(e)}function h(e){l.getState().getPlayer().getMap().setShipOnDrag({name:e.dataset.shipName,length:e.dataset.shipLength})}function g(){const t=document.getElementById("field-container-setup");for(let n=0;n<e.length;n+=1)t.children[e[n]].className="field";n()}function m(e,t){e&&(document.querySelector(`[data-ship-name=${t}]`).classList.add("hidden"),function(){const e=document.querySelectorAll(".ship-image-container"),t=document.getElementById("continue-button");5===e.length&&(t.classList.remove("disabled"),t.removeEventListener("keydown",b))}())}function f(t,s){const i=l.getState().getPlayer().getMap(),o=i.getBoard(),r=i.getAxis(),c=i.getShipOnDrag();let{length:u}=c;n();let d=!1;if("X"===r)for(let n=s;n<a.roundNearestTenExceptZero(s+1);n+=1){const[s,i]=a.getCoordinatesFromIndex(n);if(0===u)break;t.children[n].classList.add("hovering"),e.push(n),u-=1,"x"!==o[s][i]&&(d=!0)}if("Y"===r)for(let n=s;n<100;n+=10){const[s,i]=a.getCoordinatesFromIndex(n);if(0===u)break;t.children[n].classList.add("hovering"),e.push(n),u-=1,"x"!==o[s][i]&&(d=!0)}(d||0!==u)&&e.forEach((e=>{t.children[e].classList.add("red")}))}function b(e){"Enter"===e.key&&e.preventDefault()}return{initDraggableFields:function(){document.getElementById("fleet-setup").childNodes.forEach((e=>{e.addEventListener("dragstart",(t=>{s(t,e)}))})),document.getElementById("field-container-setup").childNodes.forEach((e=>{e.addEventListener("dragenter",o)})),function(){const e=document.getElementById("field-container-setup");e.childNodes.forEach(((t,n)=>{t.addEventListener("dragover",(t=>{!function(e,t,n){e.preventDefault(),f(t,n)}(t,e,n)}))}))}(),document.getElementById("field-container-setup").childNodes.forEach((e=>{e.addEventListener("dragleave",r)})),function(){const e=document.getElementById("field-container-setup");e.childNodes.forEach(((t,n)=>{t.addEventListener("drop",(()=>{!function(e,t){const[n,s]=a.getCoordinatesFromIndex(t),[i,o]=c(n,s);y.loadFleet(e),m(i,o),g(),document.querySelectorAll(".ship-card.hidden").forEach((e=>e.setAttribute("tabindex","-1")))}(e,n)}))}))}(),function(){const e=document.getElementById("fleet-setup"),t=document.getElementById("field-container-setup"),n=document.getElementById("app"),s=[null];e.childNodes.forEach((a=>{a.addEventListener("touchmove",(i=>u(i,a,t,e,n,s)),{passive:!1})}))}(),document.getElementById("fleet-setup").childNodes.forEach((e=>{e.addEventListener("touchend",(t=>{d(t,e)}))}))},preventEnterDefault:b}})(),O=A,F=(()=>{function e(){const e=a.create("section",{id:"setup-container",className:"setup-container"});return e.appendChild(function(){const e=a.create("div",{className:"board-fleet-container"});return a.appendAll(e,[a.createMap("setup"),t()]),e.querySelector("#board-setup").appendChild(function(){const e=a.create("div",{id:"axis-button-container",className:"axis-button-container"}),t=a.create("button",{id:"x-button",className:"axis-button",textContent:"X axis"}),n=a.create("button",{id:"y-button",className:"axis-button",textContent:"Y axis"});return t.classList.add("selected"),a.appendAll(e,[t,n]),e}()),e}()),e}function t(){const e=a.create("section",{id:"fleet-setup",className:"fleet-setup"});return["carrier","battleship","cruiser","submarine","destroyer"].forEach((t=>{const n=N.createShipCard(t);e.appendChild(n)})),e}function n(){const e=a.create("section",{id:"reset-continue-section",className:"reset-continue-section"}),t=a.create("button",{id:"reset-button",className:"reset-button",textContent:"Reset"}),n=a.create("button",{id:"continue-button",className:"continue-button",textContent:"Confirm"});return a.appendAll(e,[t,n]),e}function s(e,t){const n=l.getState().getPlayer().getMap();"x-button"===e.id?n.setAxisX():n.setAxisY(),e.classList.add("selected"),t.classList.remove("selected")}function i(){document.querySelectorAll(".ship-card").forEach((e=>e.setAttribute("tabindex",0)))}function o(){l.state.getPlayer().getMap().areAllShipsFound()&&P.loadBattleContent()}function r(){const e=document.getElementById("continue-button");e.classList.add("disabled"),e.addEventListener("keydown",O.preventEnterDefault)}return{loadSetupContent:function(){const t=document.getElementById("app");t.classList.replace("pregame","setup"),t.appendChild(function(){const t=a.create("div",{className:"setup-wrapper"});return a.appendAll(t,[N.createMessageSection(["setup","agent"]),e(),n()]),t}()),function(){const e=document.getElementById("message-agent");N.addTypeWriterMessage(e,B.getWelcomeMessage())}(),function(){const e=document.getElementById("x-button"),t=document.getElementById("y-button");e.addEventListener("click",(()=>s(e,t))),t.addEventListener("click",(()=>s(t,e)))}(),function(){const e=document.getElementById("reset-button"),t=document.getElementById("continue-button");console.log(l.getState().getPlayer().getMap());const n=l.getState().getPlayer().getMap().getBoard();e.addEventListener("click",(()=>function(e){const t=document.getElementById("field-container-setup");(function(){const e=l.getState().getPlayer().getMap();(function(){const e=document.getElementById("fleet-setup"),t=document.getElementById("message-agent");e.childNodes.forEach((e=>{e.classList.contains("hidden")&&(e.classList.remove("hidden"),t.classList.add("reset"))}))})(),e.getFleet().forEach((e=>e.resetFound())),e.setFleetEmpty()})(),function(e){for(let t=0;t<e.length;t+=1)for(let n=0;n<e[0].length;n+=1)e[t][n]="x"}(e),t.querySelectorAll(".ship-image-container").forEach((e=>e.remove())),r(),i()}(n))),t.addEventListener("click",o)}(),r(),i()}}})(),Y=F;(()=>{function e(){!function(){const e=document.getElementById("name-input").value.toString().trim();e&&l.getState().getPlayer().setName(`Captain ${e}`),console.log(e)}(),a.deleteAppContent(),Y.loadSetupContent(),O.initDraggableFields()}function t(){const e=a.create("section",{className:"pregame-card"});return a.appendAll(e,[a.create("h1",{textContent:"BATTLESHIP"}),n(),s()]),e}function n(){const e=a.create("div",{className:"name-form"}),t=a.create("input",{type:"text",id:"name-input",className:"name-input",placeholder:"Captain name",minLength:0,maxLength:15}),n=a.create("span",{className:"input-border"});return a.appendAll(e,[t,n]),e}function s(){const e=a.create("button",{type:"button",id:"play-now-button",className:"play-now-button"}),t=a.create("span",{className:"text-play-button",textContent:"ENTER COMBAT"});return e.appendChild(t),e}function i(){const e=a.create("div",{className:"button-container"}),t=a.create("a",{id:"github-button",className:"github-button",textContent:"GITHUB",href:"https://github.com/lovrozagar",target:"blank"});return e.appendChild(t),e}return{loadPregameContent:function(){!function(){const e=document.getElementById("app");e.classList.add("pregame"),a.appendAll(e,[t(),i()])}(),document.getElementById("play-now-button").addEventListener("click",e),I.BackgroundOnFirstTouch()}}})().loadPregameContent()}},e=>{e(e.s=178)}]);